minimum-vagga: v0.6.0

containers:
  redis:
    setup:
    - !Alpine v3.4
    - !Install [redis]
    - !EnsureDir /storage
    - !EnsureDir /config
    volumes:
      /storage: !Persistent
        name: redis
        init-command: _copy-example-db
      /config: !BindRO /work/config

commands:
  _copy-example-db: !Command
    container: redis
    run: cp examples/dump.rdb /storage/

  redis: !Command
    container: redis
    run:
    - redis-server
    - /config/redis.conf